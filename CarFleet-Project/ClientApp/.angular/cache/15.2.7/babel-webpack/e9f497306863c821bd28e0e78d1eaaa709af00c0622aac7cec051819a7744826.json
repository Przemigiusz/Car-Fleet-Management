{"ast":null,"code":"import { __decorate } from \"tslib\";\n/* eslint-disable @angular-eslint/component-selector */\n/* eslint-disable no-debugger */\nimport { Component } from '@angular/core';\nimport { Vehicle } from '../../models/Vehicle';\nimport { FormGroup, Validators } from '@angular/forms';\nimport { ReplaySubject, takeUntil } from 'rxjs';\nlet NewCarComponent = class NewCarComponent {\n  updateValue(opElement) {\n    if (opElement.isChecked === false) {\n      opElement.isChecked = true;\n    } else {\n      opElement.isChecked = false;\n    }\n  }\n  constructor(addCarService, getEquipmentElementsService, formBuilder, getFiltersService) {\n    this.addCarService = addCarService;\n    this.getEquipmentElementsService = getEquipmentElementsService;\n    this.formBuilder = formBuilder;\n    this.getFiltersService = getFiltersService;\n    this.isExpanded = false;\n    this.addCarForm = new FormGroup({});\n    this.vehicleImages = []; //Photos of the car\n    this.onDestroy$ = new ReplaySubject(1);\n  }\n  ngOnDestroy() {\n    this.onDestroy$.next(true);\n    this.onDestroy$.complete();\n  }\n  ngOnInit() {\n    this.initForm();\n    this.getEquipmentElementsService.getEquipmentElements().pipe(takeUntil(this.onDestroy$)).subscribe({\n      next: r => {\n        this.equipment = r;\n        this.operationalEquipment = [];\n        for (const el of this.equipment) {\n          this.operationalEquipment.push({\n            equipmentElement: el,\n            isChecked: false\n          });\n        }\n      },\n      error: err => {\n        console.log(\"error\", err);\n      }\n    }), this.getFiltersService.getCarbodies().pipe(takeUntil(this.onDestroy$)).subscribe({\n      next: r => {\n        this.carbodies = r;\n      },\n      error: err => {\n        console.log(\"error\", err);\n      }\n    });\n    this.getFiltersService.getFuels().pipe(takeUntil(this.onDestroy$)).subscribe({\n      next: r => {\n        this.fuels = r;\n      },\n      error: err => {\n        console.log(\"error\", err);\n      }\n    });\n    this.getFiltersService.getTransmissionTypes().pipe(takeUntil(this.onDestroy$)).subscribe({\n      next: r => {\n        this.transmissionTypes = r;\n      },\n      error: err => {\n        console.log(\"error\", err);\n      }\n    }), this.getFiltersService.getModels().pipe(takeUntil(this.onDestroy$)).subscribe({\n      next: r => {\n        this.models = r;\n      },\n      error: err => {\n        console.log(\"error\", err);\n      }\n    }), this.getFiltersService.getBrands().pipe(takeUntil(this.onDestroy$)).subscribe({\n      next: r => {\n        this.brands = r;\n      },\n      error: err => {\n        console.log(\"error\", err);\n      }\n    });\n  }\n  initForm() {\n    this.addCarForm = this.formBuilder.group({\n      brand: ['', Validators.required],\n      model: ['', Validators.required],\n      yearOfProduction: ['', Validators.required],\n      mileage: ['', Validators.required],\n      fuel: ['', Validators.required],\n      doorsAmount: ['', Validators.required],\n      carbodyType: ['', Validators.required],\n      transmissionType: ['', Validators.required],\n      vehicleImage: [null, Validators.required]\n    });\n  }\n  fileChanged(event) {\n    const imageInputElement = event.target;\n    if (imageInputElement.files && imageInputElement.files.length > 0) {\n      const files = imageInputElement.files;\n      for (const file of files) {\n        this.vehicleImages.push(file);\n      }\n    }\n  }\n  submitForm() {\n    if (this.addCarForm.valid) {\n      const formData = this.addCarForm.value;\n      const newVehicle = new Vehicle();\n      newVehicle.brandId = this.brands.find(brand => brand.brandName === formData.brand).brandId;\n      newVehicle.modelId = this.models.find(model => model.modelName === formData.model).modelId;\n      newVehicle.yearOfProduction = formData.yearOfProduction;\n      newVehicle.mileage = formData.mileage;\n      formData.fuels.forEach(f1 => {\n        const matchingFuel = this.fuels.find(f2 => f2.fuelName === f1);\n        if (matchingFuel) {\n          newVehicle.fuels.push(matchingFuel);\n        }\n      });\n      newVehicle.doorsAmount = formData.doorsAmount;\n      newVehicle.carbodyId = this.carbodies.find(c => c.carbodyName === formData.carBodyType).carbodyId;\n      for (const opElement of this.operationalEquipment) {\n        if (opElement.isChecked === true) {\n          const matchingEquipmentElement = this.equipment.find(ee => ee.elementId === opElement.elementId);\n          if (matchingEquipmentElement) {\n            newVehicle.equipment.push(matchingEquipmentElement);\n          }\n        }\n      }\n      this.addCarService.addVehicle(newVehicle).pipe(takeUntil(this.onDestroy$)).subscribe({\n        next: r => {\n          debugger;\n        },\n        error: err => {\n          console.log(\"błąd\"), console.log(err);\n        }\n      });\n    } else {\n      console.log(\"Form is not valid!!!\");\n      this.getFormValidationErrors();\n    }\n  }\n  getFormValidationErrors() {\n    Object.keys(this.addCarForm.controls).forEach((key, value) => {\n      const controlErrors = this.addCarForm.get(key).errors;\n      Object.keys(controlErrors || {}).forEach(keyError => {\n        console.log(`Key control: ${key}, keyError: ${keyError}, errValue: ${controlErrors[keyError]}`);\n      });\n    });\n  }\n  collapse() {\n    this.isExpanded = false;\n  }\n  toggle() {\n    this.isExpanded = !this.isExpanded;\n  }\n};\nNewCarComponent = __decorate([Component({\n  selector: 'new-car',\n  templateUrl: './new-car.component.html',\n  styleUrls: ['./new-car.component.css']\n})], NewCarComponent);\nexport { NewCarComponent };","map":{"version":3,"mappings":"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","names":["Component","Vehicle","FormGroup","Validators","ReplaySubject","takeUntil","NewCarComponent","updateValue","opElement","isChecked","constructor","addCarService","getEquipmentElementsService","formBuilder","getFiltersService","ngOnDestroy","onDestroy$","next","complete","ngOnInit","initForm","getEquipmentElements","pipe","subscribe","r","equipment","operationalEquipment","el","push","equipmentElement","error","err","console","log","getCarbodies","carbodies","getFuels","fuels","getTransmissionTypes","transmissionTypes","getModels","models","getBrands","brands","addCarForm","group","brand","required","model","yearOfProduction","mileage","fuel","doorsAmount","carbodyType","transmissionType","vehicleImage","fileChanged","event","imageInputElement","target","files","length","file","vehicleImages","submitForm","valid","formData","value","newVehicle","brandId","find","brandName","modelId","modelName","forEach","f1","matchingFuel","f2","fuelName","carbodyId","c","carbodyName","carBodyType","matchingEquipmentElement","ee","elementId","addVehicle","getFormValidationErrors","Object","keys","controls","key","controlErrors","get","errors","keyError","collapse","isExpanded","toggle","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["C:\\Users\\rutko\\source\\repos\\Car-Fleet-Management\\CarFleet-Project\\ClientApp\\src\\app\\new-car\\new-car.component.ts"],"sourcesContent":["/* eslint-disable @angular-eslint/component-selector */\r\n/* eslint-disable no-debugger */\r\nimport { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { VehiclesService } from '../../services/vehicles.service';\r\nimport { EquipmentService } from '../../services/equipment.service';\r\nimport { FiltersService } from '../../services/filters.service';\r\nimport { AddCarInterface } from '../../interfaces/add-car.interface';\r\nimport { Vehicle } from '../../models/Vehicle';\r\nimport { EquipmentElement } from '../../models/EquipmentElement';\r\nimport { FormBuilder, FormGroup, Validators, ValidationErrors } from '@angular/forms';\r\nimport { ReplaySubject, takeUntil } from 'rxjs';\r\nimport { Brand } from '../../models/Brand';\r\nimport { Model } from '../../models/Model';\r\nimport { Fuel } from '../../models/Fuel';\r\nimport { Carbody } from '../../models/Carbody';\r\nimport { TransmissionType } from '../../models/TransmissionType';\r\n\r\n@Component({\r\n  selector: 'new-car',\r\n  templateUrl: './new-car.component.html',\r\n  styleUrls: ['./new-car.component.css'],\r\n})\r\nexport class NewCarComponent implements OnInit, OnDestroy {\r\n  private isExpanded = false;\r\n  public addCarForm: FormGroup = new FormGroup({});\r\n\r\n  private equipment: EquipmentElement[]; //Whole equipment elements\r\n  public operationalEquipment: any[]; //Elements which are available in the car\r\n  public vehicleImages: File[] = []; //Photos of the car\r\n\r\n  public brands: Brand[];\r\n  public models: Model[];\r\n  public fuels: Fuel[];\r\n  public carbodies: Carbody[];\r\n  public transmissionTypes: TransmissionType[];\r\n\r\n  private onDestroy$: ReplaySubject<boolean> = new ReplaySubject<boolean>(1);\r\n\r\n  updateValue(opElement: any) {\r\n    if (opElement.isChecked === false) {\r\n      opElement.isChecked = true;\r\n    } else {\r\n      opElement.isChecked = false;\r\n    }\r\n }\r\n\r\n  constructor(private addCarService: VehiclesService, private getEquipmentElementsService: EquipmentService,\r\n    private formBuilder: FormBuilder, private getFiltersService: FiltersService) {}\r\n\r\n  public ngOnDestroy(): void {\r\n    this.onDestroy$.next(true);\r\n    this.onDestroy$.complete();\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.initForm();\r\n    this.getEquipmentElementsService.getEquipmentElements()\r\n      .pipe(takeUntil(this.onDestroy$))\r\n      .subscribe(\r\n        {\r\n          next: r => {\r\n            this.equipment = r;\r\n            this.operationalEquipment = [];\r\n            for (const el of this.equipment) {\r\n              this.operationalEquipment.push({ equipmentElement: el, isChecked: false });\r\n            }\r\n          },\r\n          error: err => { console.log(\"error\", err); }\r\n      }), \r\n\r\n    this.getFiltersService.getCarbodies()\r\n      .pipe(takeUntil(this.onDestroy$))\r\n      .subscribe(\r\n        {\r\n          next: r => { this.carbodies = r; },\r\n          error: err => { console.log(\"error\", err); }\r\n        });\r\n\r\n    this.getFiltersService.getFuels()\r\n      .pipe(takeUntil(this.onDestroy$))\r\n      .subscribe(\r\n        {\r\n          next: r => { this.fuels = r; },\r\n          error: err => { console.log(\"error\", err); }\r\n        });\r\n\r\n    this.getFiltersService.getTransmissionTypes()\r\n      .pipe(takeUntil(this.onDestroy$))\r\n      .subscribe(\r\n        {\r\n          next: r => { this.transmissionTypes = r; },\r\n          error: err => { console.log(\"error\", err); }\r\n        }),\r\n\r\n      this.getFiltersService.getModels()\r\n        .pipe(takeUntil(this.onDestroy$))\r\n        .subscribe(\r\n          {\r\n            next: r => { this.models = r; },\r\n            error: err => { console.log(\"error\", err); }\r\n          }),\r\n\r\n      this.getFiltersService.getBrands()\r\n        .pipe(takeUntil(this.onDestroy$))\r\n        .subscribe(\r\n          {\r\n            next: r => { this.brands = r; },\r\n            error: err => { console.log(\"error\", err); }\r\n          })\r\n  }\r\n\r\n  initForm() {\r\n    this.addCarForm = this.formBuilder.group({\r\n      brand: ['', Validators.required],\r\n      model: ['', Validators.required],\r\n      yearOfProduction: ['', Validators.required],\r\n      mileage: ['', Validators.required],\r\n      fuel: ['', Validators.required],\r\n      doorsAmount: ['', Validators.required],\r\n      carbodyType: ['', Validators.required],\r\n      transmissionType: ['', Validators.required],\r\n      vehicleImage: [null, Validators.required]\r\n    })\r\n  }\r\n \r\n  fileChanged(event: Event) {\r\n    const imageInputElement = event.target as HTMLInputElement;\r\n    if (imageInputElement.files && imageInputElement.files.length > 0) {\r\n      const files = imageInputElement.files;\r\n      for (const file of files) {\r\n        this.vehicleImages.push(file);\r\n      }\r\n    }\r\n  }\r\n\r\n  submitForm() {\r\n    if (this.addCarForm.valid) {\r\n      const formData: AddCarInterface = this.addCarForm.value;\r\n      const newVehicle: Vehicle = new Vehicle();\r\n\r\n      newVehicle.brandId = this.brands.find(brand => brand.brandName === formData.brand)!.brandId!;\r\n      newVehicle.modelId = this.models.find(model => model.modelName === formData.model)!.modelId!;\r\n\r\n      newVehicle.yearOfProduction = formData.yearOfProduction;\r\n      newVehicle.mileage = formData.mileage;\r\n\r\n      formData.fuels.forEach(f1 => {\r\n        const matchingFuel = this.fuels.find(f2 => f2.fuelName === f1);\r\n        if (matchingFuel) {\r\n          newVehicle.fuels.push(matchingFuel);\r\n        }\r\n      })\r\n\r\n      newVehicle.doorsAmount = formData.doorsAmount;\r\n      newVehicle.carbodyId = this.carbodies.find(c => c.carbodyName === formData.carBodyType)!.carbodyId!;\r\n\r\n      for (const opElement of this.operationalEquipment) {\r\n        if (opElement.isChecked === true) {\r\n          const matchingEquipmentElement = this.equipment.find(ee => ee.elementId === opElement.elementId);\r\n          if (matchingEquipmentElement) {\r\n            newVehicle.equipment.push(matchingEquipmentElement);\r\n          }\r\n        }\r\n      }\r\n      this.addCarService.addVehicle(newVehicle)\r\n        .pipe(takeUntil(this.onDestroy$))\r\n        .subscribe(\r\n          {\r\n            next: r => { debugger },\r\n            error: err => { console.log(\"błąd\"), console.log(err) }\r\n          });\r\n    }\r\n    else {\r\n      console.log(\"Form is not valid!!!\");\r\n      this.getFormValidationErrors();\r\n    } \r\n  }\r\n\r\n  getFormValidationErrors() {\r\n    Object.keys(this.addCarForm.controls).forEach((key,value) => {\r\n      const controlErrors: ValidationErrors = this.addCarForm.get(key)!.errors!;\r\n      Object.keys(controlErrors || {}).forEach(keyError => {\r\n        console.log(`Key control: ${key}, keyError: ${keyError}, errValue: ${controlErrors[keyError]}`);\r\n      });\r\n    });\r\n  }\r\n\r\n  collapse() {\r\n    this.isExpanded = false;\r\n  }\r\n\r\n  toggle() {\r\n    this.isExpanded = !this.isExpanded;\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}